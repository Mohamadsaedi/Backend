{% extends 'base.html' %}

{% block content %}
    <h1>پست‌های اخیر</h1>
    <div>
        <strong>فیلتر بر اساس تگ:</strong>
        {% for tag in all_tags %}
            <a href="/?tag={{ tag.name }}" style="margin: 0 5px;">#{{ tag.name }}</a>
        {% endfor %}
        <a href="/" style="margin: 0 5px; font-weight: bold;">(نمایش همه)</a>
    </div>
    <hr>
    <form action="{% url 'search_results' %}" method="get">
        <input name="q" type="text" placeholder="جستجو در میان پست‌ها...">
        <button type="submit">جستجو</button>
    </form>
    <hr>
    <div class="posts-container">
        {% for post in posts_list %}
            <div class="post-card" style="border: 1px solid #ddd; border-radius: 12px; padding: 20px; margin: 20px 0; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <h2 style="color: #333; margin-bottom: 15px;">
                    <a href="{% url 'post_detail' pk=post.pk %}" style="text-decoration: none; color: #007bff;">{{ post.title }}</a>
                </h2>
                
                {% if post.image %}
                    <div class="post-image" style="text-align: center; margin: 15px 0;">
                        <img src="{{ post.image.url }}" alt="{{ post.title }}" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                    </div>
                {% endif %}
                
                <p style="line-height: 1.6; color: #555; margin: 15px 0;">{{ post.body|truncatewords:50 }}</p>
                
                <div class="post-tags" style="margin: 15px 0;">
                    {% for tag in post.tags.all %}
                        <span style="background-color: #e9ecef; color: #495057; padding: 4px 8px; border-radius: 15px; margin: 0 5px; font-size: 0.9em;">#{{ tag.name }}</span>
                    {% endfor %}
                </div>
                
                <div class="post-meta" style="border-top: 1px solid #eee; padding-top: 15px; margin-top: 15px;">
                    <small style="color: #6c757d; display: block; text-align: right;">منتشر شده در: {{ post.created_at|date:"Y/m/d ساعت H:i" }}</small>
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock content %}